{% extends"base.html" %} {% load static %} {% block title %}Analytics Dashboard{% endblock %} {% block extra_css %} <style> .analytics-container { max-width: 1400px; margin: 0 auto; padding: 2rem; } .metrics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; } .metric-card { background: var(--card-bg, white); border-radius: 8px; padding: 1.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1); } .metric-value { font-size: 2rem; font-weight: bold; color: var(--primary-color, #007bff); } .metric-label { color: var(--text-muted, #6c757d); font-size: 0.875rem; margin-top: 0.5rem; } .chart-container { background: var(--card-bg, white); border-radius: 8px; padding: 1.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem; } .chart-title { font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem; } .funnel-container { display: flex; flex-direction: column; gap: 0.5rem; } .funnel-step { display: flex; align-items: center; gap: 1rem; } .funnel-bar { flex-grow: 1; height: 40px; background: linear-gradient(90deg, var(--primary-color, #007bff) var(--percentage), #e9ecef var(--percentage)); border-radius: 4px; position: relative; display: flex; align-items: center; padding: 0 1rem; } .funnel-label { color: white; font-weight: 500; z-index: 1; } .funnel-value { margin-left: auto; color: white; z-index: 1; } .journey-path { display: flex; align-items: center; gap: 1rem; padding: 0.75rem; background: var(--bg-light, #f8f9fa); border-radius: 4px; margin-bottom: 0.5rem; } .journey-arrow { color: var(--text-muted, #6c757d); } .ab-test-variant { display: flex; justify-content: space-between; padding: 1rem; background: var(--bg-light, #f8f9fa); border-radius: 4px; margin-bottom: 0.5rem; } .variant-winner { background: #d4edda; border: 1px solid #28a745; } .period-selector { display: flex; gap: 0.5rem; margin-bottom: 2rem; } .period-btn { padding: 0.5rem 1rem; border: 1px solid var(--border-color, #dee2e6); background: white; border-radius: 4px; cursor: pointer; transition: all 0.2s; } .period-btn.active { background: var(--primary-color, #007bff); color: white; border-color: var(--primary-color, #007bff); } .data-table { width: 100%; border-collapse: collapse; } .data-table th, .data-table td { padding: 0.75rem; text-align: left; border-bottom: 1px solid var(--border-color, #dee2e6); } .data-table th { font-weight: 600; background: var(--bg-light, #f8f9fa); } </style> {% endblock %} {% block content %} <div class="analytics-container"> <h1>Analytics Dashboard</h1> {% if error %} <div class="alert alert-danger">{{ error }}</div> {% else %} <!-- Period Selector --> <div class="period-selector"> <button class="period-btn {% if period_days == 1 %}active{% endif %}" data-days="1">Today</button> <button class="period-btn {% if period_days == 7 %}active{% endif %}" data-days="7">7 Days</button> <button class="period-btn {% if period_days == 30 %}active{% endif %}" data-days="30">30 Days</button> </div> <!-- Key Metrics --> <div class="metrics-grid"> <div class="metric-card"> <div class="metric-value">{{ metrics.total_page_views|default:0 }}</div> <div class="metric-label">Total Page Views</div> </div> <div class="metric-card"> <div class="metric-value">{{ metrics.total_events|default:0 }}</div> <div class="metric-label">Total Events</div> </div> <div class="metric-card"> <div class="metric-value">{{ metrics.total_conversions|default:0 }}</div> <div class="metric-label">Total Conversions</div> </div> <div class="metric-card"> <div class="metric-value">{{ metrics.conversion_rate|default:0 }}%</div> <div class="metric-label">Conversion Rate</div> </div> </div> <!-- Page Views Chart --> <div class="chart-container"> <h2 class="chart-title">Page Views Over Time</h2> <canvas id="pageViewsChart"></canvas> </div> <!-- Top Pages --> <div class="chart-container"> <h2 class="chart-title">Top Pages</h2> <table class="data-table"> <thead> <tr> <th>Page</th> <th>Views</th> </tr> </thead> <tbody> {% for page, views in summary.top_pages.items|slice:":10" %} <tr> <td>{{ page }}</td> <td>{{ views }}</td> </tr> {% empty %} <tr> <td colspan="2">No data available</td> </tr> {% endfor %} </tbody> </table> </div> <!-- Device Breakdown --> <div class="chart-container"> <h2 class="chart-title">Device Breakdown</h2> <div style="max-width: 300px;"> <canvas id="deviceChart"></canvas> </div> </div> <!-- Browser Stats --> <div class="chart-container"> <h2 class="chart-title">Browser Distribution</h2> <div style="max-width: 300px;"> <canvas id="browserChart"></canvas> </div> </div> <!-- Events --> <div class="chart-container"> <h2 class="chart-title">Event Tracking</h2> <table class="data-table"> <thead> <tr> <th>Event</th> <th>Count</th> </tr> </thead> <tbody> {% for event, count in summary.events.items %} <tr> <td>{{ event }}</td> <td>{{ count }}</td> </tr> {% empty %} <tr> <td colspan="2">No events tracked</td> </tr> {% endfor %} </tbody> </table> </div> <!-- Conversions --> <div class="chart-container"> <h2 class="chart-title">Conversions</h2> <table class="data-table"> <thead> <tr> <th>Type</th> <th>Count</th> </tr> </thead> <tbody> {% for type, count in summary.conversions.items %} <tr> <td>{{ type }}</td> <td>{{ count }}</td> </tr> {% empty %} <tr> <td colspan="2">No conversions tracked</td> </tr> {% endfor %} </tbody> </table> </div> {% endif %} </div> {% endblock %} {% block extra_js %} <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <script> document.addEventListener('DOMContentLoaded', function() { // Period selector document.querySelectorAll('.period-btn').forEach(btn => { btn.addEventListener('click', function() { const days = this.dataset.days; window.location.href = `?days=${days}`; }); }); // Page Views Chart const pageViewsCtx = document.getElementById('pageViewsChart'); if (pageViewsCtx) { const pageViewsData = {{ summary.page_views|safe|default:"{}" }}; new Chart(pageViewsCtx, { type: 'line', data: { labels: Object.keys(pageViewsData), datasets: [{ label: 'Page Views', data: Object.values(pageViewsData), borderColor: 'rgb(75, 192, 192)', tension: 0.1 }] }, options: { responsive: true, maintainAspectRatio: false, height: 300 } }); } // Device Chart const deviceCtx = document.getElementById('deviceChart'); if (deviceCtx) { const deviceData = {{ summary.devices|safe|default:"{}" }}; new Chart(deviceCtx, { type: 'doughnut', data: { labels: ['Mobile', 'Desktop'], datasets: [{ data: [deviceData.mobile || 0, deviceData.desktop || 0], backgroundColor: ['#36a2eb', '#ff6384'] }] } }); } // Browser Chart const browserCtx = document.getElementById('browserChart'); if (browserCtx) { const browserData = {{ summary.browsers|safe|default:"{}" }}; new Chart(browserCtx, { type: 'pie', data: { labels: Object.keys(browserData), datasets: [{ data: Object.values(browserData), backgroundColor: [ '#ff6384', '#36a2eb', '#ffcd56', '#4bc0c0', '#9966ff' ] }] } }); } // Auto-refresh every 60 seconds setTimeout(() => { location.reload(); }, 60000); }); </script> {% endblock %}