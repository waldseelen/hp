{% extends 'base.html' %} {% block title %}Performance Dashboard - Portfolio{% endblock %} {% block content %} <div class="container mx-auto px-4 py-8"> <div class="max-w-7xl mx-auto"> <!-- Header --> <div class="mb-8"> <div class="flex items-center justify-between"> <div> <h1 class="text-3xl font-bold text-white mb-2">Performance Dashboard</h1> <p class="text-gray-400">Real-time performance monitoring and analytics</p> </div> <div class="flex items-center space-x-4"> <div class="bg-gray-800 px-4 py-2 rounded-lg"> <span class="text-sm text-gray-400">Last Updated:</span> <span class="text-white ml-2" id="last-updated">--:--:--</span> </div> <button id="refresh-btn" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg transition-colors"> <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path> </svg> Refresh </button> </div> </div> </div> {% if error %} <div class="bg-red-500/20 border border-red-500 rounded-lg p-4 mb-8"> <div class="flex items-center"> <svg class="w-5 h-5 text-red-400 mr-3" fill="currentColor" viewBox="0 0 20 20"> <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path> </svg> <span class="text-red-200">{{ error }}</span> </div> </div> {% else %} <!-- Health Score Card --> <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-xl p-6 mb-8 border border-gray-700"> <div class="flex items-center justify-between"> <div> <h2 class="text-2xl font-semibold text-white mb-2">Performance Health Score</h2> <div class="flex items-center space-x-4"> <div class="text-4xl font-bold text-white" id="health-score"> {{ health_score.overall|default:"--" }} </div> <div class="text-2xl font-semibold" id="health-grade"> <span class="px-3 py-1 rounded-lg {% if health_score.grade == 'A' %}bg-green-500{% elif health_score.grade == 'B' %}bg-blue-500{% elif health_score.grade == 'C' %}bg-yellow-500{% elif health_score.grade == 'D' %}bg-orange-500{% else %}bg-red-500{% endif %}"> {{ health_score.grade|default:"?" }} </span> </div> </div> <p class="text-gray-400 mt-2">Based on Core Web Vitals and performance metrics</p> </div> <div class="w-32 h-32"> <canvas id="health-chart"></canvas> </div> </div> </div> <!-- Core Web Vitals --> <div class="grid grid-cols-3 gap-6 mb-8"> <!-- LCP Card --> <div class="bg-gray-800/50 backdrop-blur-sm rounded-lg p-6 border border-gray-700"> <div class="flex items-center justify-between mb-4"> <h3 class="font-semibold text-white">Largest Contentful Paint</h3> <div class="w-3 h-3 rounded-full {% if summary.lcp.avg <= 2500 %}bg-green-400{% elif summary.lcp.avg <= 4000 %}bg-yellow-400{% else %}bg-red-400{% endif %}"></div> </div> <div class="text-2xl font-bold text-white mb-2" id="lcp-value"> {{ summary.lcp.avg|default:"--" }}{% if summary.lcp.avg %}ms{% endif %} </div> <div class="text-sm text-gray-400"> <span>Target: &lt; 2.5s</span> {% if summary.lcp %} <span class="ml-4">P95: {{ summary.lcp.p95 }}ms</span> {% endif %} </div> <div class="mt-3"> <canvas id="lcp-chart" width="200" height="60"></canvas> </div> </div> <!-- FID Card --> <div class="bg-gray-800/50 backdrop-blur-sm rounded-lg p-6 border border-gray-700"> <div class="flex items-center justify-between mb-4"> <h3 class="font-semibold text-white">First Input Delay</h3> <div class="w-3 h-3 rounded-full {% if summary.fid.avg <= 100 %}bg-green-400{% elif summary.fid.avg <= 300 %}bg-yellow-400{% else %}bg-red-400{% endif %}"></div> </div> <div class="text-2xl font-bold text-white mb-2" id="fid-value"> {{ summary.fid.avg|default:"--" }}{% if summary.fid.avg %}ms{% endif %} </div> <div class="text-sm text-gray-400"> <span>Target: &lt; 100ms</span> {% if summary.fid %} <span class="ml-4">P95: {{ summary.fid.p95 }}ms</span> {% endif %} </div> <div class="mt-3"> <canvas id="fid-chart" width="200" height="60"></canvas> </div> </div> <!-- CLS Card --> <div class="bg-gray-800/50 backdrop-blur-sm rounded-lg p-6 border border-gray-700"> <div class="flex items-center justify-between mb-4"> <h3 class="font-semibold text-white">Cumulative Layout Shift</h3> <div class="w-3 h-3 rounded-full {% if summary.cls.avg <= 0.1 %}bg-green-400{% elif summary.cls.avg <= 0.25 %}bg-yellow-400{% else %}bg-red-400{% endif %}"></div> </div> <div class="text-2xl font-bold text-white mb-2" id="cls-value"> {{ summary.cls.avg|default:"--" }} </div> <div class="text-sm text-gray-400"> <span>Target: &lt; 0.1</span> {% if summary.cls %} <span class="ml-4">P95: {{ summary.cls.p95 }}</span> {% endif %} </div> <div class="mt-3"> <canvas id="cls-chart" width="200" height="60"></canvas> </div> </div> </div> <!-- Additional Metrics --> <div class="grid grid-cols-2 gap-8 mb-8"> <!-- Performance Metrics Table --> <div class="bg-gray-800/50 backdrop-blur-sm rounded-lg p-6 border border-gray-700"> <h3 class="text-xl font-semibold text-white mb-4">Performance Metrics</h3> <div class="overflow-x-auto"> <table class="w-full text-sm"> <thead> <tr class="border-b border-gray-700"> <th class="text-left text-gray-400 py-2">Metric</th> <th class="text-right text-gray-400 py-2">Avg</th> <th class="text-right text-gray-400 py-2">P95</th> <th class="text-right text-gray-400 py-2">Count</th> </tr> </thead> <tbody id="metrics-table"> {% for metric_name, data in summary.items %} <tr class="border-b border-gray-700/50"> <td class="py-3 text-white font-medium">{{ metric_name|upper }}</td> <td class="py-3 text-right text-gray-300">{{ data.avg }}</td> <td class="py-3 text-right text-gray-300">{{ data.p95 }}</td> <td class="py-3 text-right text-gray-400">{{ data.count }}</td> </tr> {% endfor %} </tbody> </table> </div> </div> <!-- System Information --> <div class="bg-gray-800/50 backdrop-blur-sm rounded-lg p-6 border border-gray-700"> <h3 class="text-xl font-semibold text-white mb-4">System Status</h3> <div class="space-y-4"> <div class="flex items-center justify-between"> <span class="text-gray-400">Database</span> <span class="flex items-center"> <div class="w-2 h-2 rounded-full {% if system_info.database_status == 'Connected' %}bg-green-400{% else %}bg-red-400{% endif %} mr-2"></div> <span class="text-white">{{ system_info.database_status }}</span> </span> </div> <div class="flex items-center justify-between"> <span class="text-gray-400">Cache</span> <span class="text-white">{{ system_info.cache_status }}</span> </div> <div class="flex items-center justify-between"> <span class="text-gray-400">Debug Mode</span> <span class="text-white">{{ system_info.debug_mode|yesno:"On,Off" }}</span> </div> <div class="flex items-center justify-between"> <span class="text-gray-400">Uptime</span> <span class="text-white" id="uptime">Calculating...</span> </div> </div> </div> </div> <!-- Performance Alerts --> {% if alerts %} <div class="bg-gray-800/50 backdrop-blur-sm rounded-lg p-6 border border-gray-700"> <h3 class="text-xl font-semibold text-white mb-4 flex items-center"> <svg class="w-5 h-5 text-yellow-400 mr-2" fill="currentColor" viewBox="0 0 20 20"> <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path> </svg> Recent Alerts </h3> <div class="space-y-3"> {% for alert in alerts %} <div class="flex items-center justify-between p-3 bg-gray-700/50 rounded-lg {% if alert.severity == 'critical' %}border-l-4 border-red-500{% else %}border-l-4 border-yellow-500{% endif %}"> <div> <span class="font-medium text-white">{{ alert.metric|upper }}</span> <span class="text-gray-300 ml-2">{{ alert.value }} > {{ alert.threshold }}</span> </div> <div class="text-sm text-gray-400"> {{ alert.timestamp|date:"H:i:s" }} </div> </div> {% endfor %} </div> </div> {% endif %} {% endif %} </div> </div> <!-- Dashboard JavaScript --> <script> class PerformanceDashboard { constructor() { this.refreshInterval = 30000; // 30 seconds this.charts = {}; this.init(); } init() { this.setupEventListeners(); this.updateTimestamp(); this.setupAutoRefresh(); this.initializeCharts(); } setupEventListeners() { const refreshBtn = document.getElementById('refresh-btn'); if (refreshBtn) { refreshBtn.addEventListener('click', () => this.refreshData()); } } updateTimestamp() { const now = new Date(); const timeString = now.toLocaleTimeString(); const timestampEl = document.getElementById('last-updated'); if (timestampEl) { timestampEl.textContent = timeString; } } async refreshData() { try { const response = await fetch('/api/monitoring/metrics/', { method: 'GET', headers: { 'X-Requested-With': 'XMLHttpRequest', 'Accept': 'application/json' } }); if (response.ok) { const data = await response.json(); this.updateDashboard(data); this.updateTimestamp(); } } catch (error) { console.error('Failed to refresh dashboard data:', error); } } updateDashboard(data) { // Update health score if (data.health_score) { const scoreEl = document.getElementById('health-score'); const gradeEl = document.getElementById('health-grade'); if (scoreEl) scoreEl.textContent = data.health_score.overall; if (gradeEl) { const gradeSpan = gradeEl.querySelector('span'); if (gradeSpan) { gradeSpan.textContent = data.health_score.grade; // Update grade color class gradeSpan.className = `px-3 py-1 rounded-lg ${this.getGradeColor(data.health_score.grade)}`; } } } // Update metrics values if (data.summary) { this.updateMetricValue('lcp', data.summary.lcp); this.updateMetricValue('fid', data.summary.fid); this.updateMetricValue('cls', data.summary.cls); // Update charts this.updateCharts(data.summary); } } updateMetricValue(metric, data) { if (data) { const valueEl = document.getElementById(`${metric}-value`); if (valueEl) { const suffix = metric === 'cls' ? '' : 'ms'; valueEl.textContent = `${data.avg}${suffix}`; } } } getGradeColor(grade) { const colors = { 'A': 'bg-green-500', 'B': 'bg-blue-500', 'C': 'bg-yellow-500', 'D': 'bg-orange-500', 'F': 'bg-red-500' }; return colors[grade] || 'bg-gray-500'; } initializeCharts() { // Initialize mini charts for metrics (placeholder - would use Chart.js or similar) const chartElements = ['lcp-chart', 'fid-chart', 'cls-chart', 'health-chart']; chartElements.forEach(id => { const canvas = document.getElementById(id); if (canvas) { this.createMiniChart(canvas); } }); } createMiniChart(canvas) { // Simple canvas-based mini chart (placeholder) const ctx = canvas.getContext('2d'); const width = canvas.width; const height = canvas.height; ctx.fillStyle = '#374151'; ctx.fillRect(0, 0, width, height); // Draw sample line ctx.strokeStyle = '#3B82F6'; ctx.lineWidth = 2; ctx.beginPath(); for (let i = 0; i < width; i += 10) { const y = height / 2 + Math.sin(i / 20) * 20; if (i === 0) { ctx.moveTo(i, y); } else { ctx.lineTo(i, y); } } ctx.stroke(); } updateCharts(summary) { // Update mini charts with real data (placeholder) for (const [metric, data] of Object.entries(summary)) { if (data && data.recent) { const canvas = document.getElementById(`${metric}-chart`); if (canvas) { this.updateMiniChart(canvas, data.recent); } } } } updateMiniChart(canvas, data) { const ctx = canvas.getContext('2d'); const width = canvas.width; const height = canvas.height; // Clear canvas ctx.clearRect(0, 0, width, height); ctx.fillStyle = '#1F2937'; ctx.fillRect(0, 0, width, height); if (data.length < 2) return; const max = Math.max(...data); const min = Math.min(...data); const range = max - min || 1; ctx.strokeStyle = '#3B82F6'; ctx.lineWidth = 2; ctx.beginPath(); data.forEach((value, index) => { const x = (index / (data.length - 1)) * width; const y = height - ((value - min) / range) * height; if (index === 0) { ctx.moveTo(x, y); } else { ctx.lineTo(x, y); } }); ctx.stroke(); } setupAutoRefresh() { setInterval(() => { this.refreshData(); }, this.refreshInterval); } } // Initialize dashboard when DOM is ready document.addEventListener('DOMContentLoaded', () => { new PerformanceDashboard(); }); </script> {% endblock %}