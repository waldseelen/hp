{% extends 'base/base.html' %}
{% load static %}
{% load i18n %}

{% block title %}{% trans "CodePlay - Programming Playground" %}{% endblock %}

{% block content %}
<section class="section hero-section">
  <div class="container hero-section__inner">
    <div>
      <span class="eyebrow">{% trans 'Code instantly in your browser' %}</span>
      <h1 class="hero-title">
        <span class="text-gradient-primary">Code</span>
        <span class="text-gradient-accent">Play</span>
      </h1>
      <p class="hero-lead">{% trans 'As easy as Instagram, as powerful as VS Code' %}</p>
      <div class="hero-bio">
        {% trans "Write your code, hit Enter, and see the output immediately. No installs‚Äîjust the freedom of building right from the browser." %}
      </div>
      <div class="button-row hero-actions">
        <a href="{% url 'playground:editor' %}" class="btn btn--primary" data-cursor-interactive>
          {% trans 'Start now' %}
        </a>
        <a href="{% url 'playground:gallery' %}" class="btn btn--ghost" data-cursor-interactive>
          {% trans 'Explore gallery' %}
        </a>
      </div>
      <div class="stat-grid" data-animate>
        <div class="stat-card">
          <span class="stat-value">120K+</span>
          <span class="stat-label">{% trans 'Executions' %}</span>
        </div>
        <div class="stat-card">
          <span class="stat-value">25+</span>
          <span class="stat-label">{% trans 'Languages supported' %}</span>
        </div>
        <div class="stat-card">
          <span class="stat-value">24/7</span>
          <span class="stat-label">{% trans 'Cloud editor uptime' %}</span>
        </div>
      </div>
    </div>
    <div class="feature-grid__visual">
      <div class="playground-visual" aria-hidden="true">
        <svg viewBox="0 0 320 220" xmlns="http://www.w3.org/2000/svg" role="img" aria-labelledby="playground-illustration-title">
          <title id="playground-illustration-title">{% trans 'CodePlay editor preview' %}</title>
          <defs>
            <linearGradient id="playgroundGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#6366f1" stop-opacity="0.45" />
              <stop offset="100%" stop-color="#22d3ee" stop-opacity="0.65" />
            </linearGradient>
          </defs>
          <rect x="12" y="16" width="296" height="188" rx="18" fill="rgba(15,23,42,0.9)" stroke="rgba(99,102,241,0.35)" stroke-width="2" />
          <rect x="12" y="16" width="296" height="44" rx="18" fill="rgba(99,102,241,0.18)" />
          <circle cx="40" cy="38" r="6" fill="#ef4444" />
          <circle cx="58" cy="38" r="6" fill="#f59e0b" />
          <circle cx="76" cy="38" r="6" fill="#10b981" />
          <rect x="36" y="76" width="248" height="18" rx="6" fill="rgba(148,163,184,0.28)" />
          <rect x="36" y="106" width="200" height="18" rx="6" fill="url(#playgroundGradient)" />
          <rect x="36" y="136" width="164" height="18" rx="6" fill="rgba(148,163,184,0.2)" />
          <rect x="36" y="166" width="220" height="18" rx="6" fill="rgba(99,102,241,0.25)" />
          <rect x="214" y="98" width="72" height="72" rx="12" fill="rgba(34,211,238,0.18)" stroke="rgba(34,211,238,0.35)" stroke-width="2" />
          <path d="M240 126l16 16-16 16" stroke="rgba(34,211,238,0.8)" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" />
        </svg>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container">
    <header class="section__header align-start">
      <span class="eyebrow">{% trans 'How it works' %}</span>
      <h2 class="section-title">{% trans 'Ship something in minutes' %}</h2>
      <p class="section-lead">{% trans 'Pick a language, write your code, share the result. That‚Äôs it.' %}</p>
    </header>
    <div class="tile-grid tile-grid--three">
      <article class="card card--step" data-animate-card>
        <span class="step-number">01</span>
        <h3 class="card__title">{% trans 'Choose a language' %}</h3>
        <p class="card__text">{% trans 'Start from curated templates tailored to your favourite stack.' %}</p>
        <ul class="card__list">
          <li><span>Python, JavaScript, Go, Rust‚Ä¶</span></li>
          <li><span>{% trans 'Framework presets' %}</span></li>
        </ul>
      </article>
      <article class="card card--step" data-animate-card>
        <span class="step-number">02</span>
        <h3 class="card__title">{% trans 'Write your code' %}</h3>
        <p class="card__text">{% trans 'Experiment quickly with AI-assisted hints and immediate output.' %}</p>
        <ul class="card__list">
          <li><span>{% trans 'Auto formatting' %}</span></li>
          <li><span>{% trans 'Live preview pane' %}</span></li>
        </ul>
      </article>
      <article class="card card--step" data-animate-card>
        <span class="step-number">03</span>
        <h3 class="card__title">{% trans 'Share and iterate' %}</h3>
        <p class="card__text">{% trans 'Generate shareable links, collect feedback, and keep improving.' %}</p>
        <ul class="card__list">
          <li><span>{% trans 'Version history' %}</span></li>
          <li><span>{% trans 'Embed-ready snippets' %}</span></li>
        </ul>
      </article>
    </div>
  </div>
</section>

{% if starter_templates %}
<section class="section section--tint">
  <div class="container">
    <header class="section__header align-start">
      <span class="eyebrow">{% trans 'Starter templates' %}</span>
      <h2 class="section-title">{% trans 'Kick off with ready-made blueprints' %}</h2>
      <p class="section-lead">{% trans 'Jump straight into prototyping with curated templates for popular stacks.' %}</p>
    </header>
    <div class="tile-grid tile-grid--two">
      {% for template in starter_templates %}
      <article class="card card--interactive" data-animate-card>
        <div class="template-card">
          <div class="template-card__header">
            <span class="tag tag--outline">{{ template.language.icon }} {{ template.language.name }}</span>
            <span class="text-xs text-gray-400">{{ template.get_complexity_display }}</span>
          </div>
          <h3 class="card__title">{{ template.title }}</h3>
          <p class="card__text">{{ template.description }}</p>
          {% if template.tags %}
          <div class="template-card__tags">
            {% for tag in template.tags %}
            <span class="tag tag--outline">{{ tag }}</span>
            {% endfor %}
          </div>
          {% endif %}
          <button onclick="loadTemplate({{ template.id }})" class="btn btn--secondary" data-cursor-interactive>
            {% trans 'Use template' %}
          </button>
        </div>
      </article>
      {% endfor %}
    </div>
  </div>
</section>
{% endif %}

<section class="section">
  <div class="container">
    <header class="section__header align-start">
      <span class="eyebrow">{% trans 'Highlights' %}</span>
      <h2 class="section-title">{% trans 'Why CodePlay?' %}</h2>
      <p class="section-lead">{% trans 'Modern tooling, frictionless collaboration, and a workflow built for iteration.' %}</p>
    </header>
    <div class="tile-grid tile-grid--two">
      <article class="card" data-animate-card>
        <div class="card__icon card__icon--blue">‚ö°</div>
        <h3 class="card__title">{% trans 'Instant output' %}</h3>
        <p class="card__text">{% trans 'See results the moment you run your code and keep the feedback loop tight.' %}</p>
      </article>
      <article class="card" data-animate-card>
        <div class="card__icon card__icon--green">üîó</div>
        <h3 class="card__title">{% trans 'Real-time sharing' %}</h3>
        <p class="card__text">{% trans 'Share links, gather comments, and build together in real time.' %}</p>
      </article>
      <article class="card" data-animate-card>
        <div class="card__icon card__icon--red">ü§ñ</div>
        <h3 class="card__title">{% trans 'AI-powered' %}</h3>
        <p class="card__text">{% trans 'Code completions, error insights, and learning nudges built in.' %}</p>
      </article>
      <article class="card" data-animate-card>
        <div class="card__icon card__icon--blue">üõ°Ô∏è</div>
        <h3 class="card__title">{% trans 'Secure sandboxes' %}</h3>
        <p class="card__text">{% trans 'Every execution runs in an isolated container, keeping your data safe.' %}</p>
      </article>
    </div>
  </div>
</section>

{% if recent_snippets %}
<section class="section section--tint">
  <div class="container">
    <header class="section__header align-start">
      <span class="eyebrow">{% trans 'Community' %}</span>
      <h2 class="section-title">{% trans 'Fresh snippets from builders' %}</h2>
      <p class="section-lead">{% trans 'Browse the latest experiments and get inspired by fellow developers.' %}</p>
    </header>
    <div class="tile-grid tile-grid--two">
      {% for snippet in recent_snippets %}
      <a href="{% url 'playground:snippet_detail' snippet.id %}" class="card card--interactive" data-animate-card>
        <div class="snippet-meta">
          <span class="tag tag--outline">{{ snippet.language.icon }} {{ snippet.language.name }}</span>
          <span>{% blocktrans with time=snippet.created_at|timesince %}{{ time }} ago{% endblocktrans %}</span>
        </div>
        <h3 class="card__title">{{ snippet.title|default:"Untitled Code" }}</h3>
        <div class="snippet-stats">
          <span>üëÅÔ∏è {{ snippet.views }}</span>
          <span>‚ù§Ô∏è {{ snippet.likes }}</span>
        </div>
      </a>
      {% endfor %}
    </div>
    <div class="button-row center section-actions">
      <a href="{% url 'playground:gallery' %}" class="btn btn--ghost" data-cursor-interactive>
        {% trans 'View all' %}
      </a>
    </div>
  </div>
</section>
{% endif %}

<section class="section">
  <div class="container">
    <div class="cta-panel" data-animate>
      <div>
        <span class="eyebrow">{% trans 'Ready to try it?' %}</span>
        <h2 class="section-title">{% trans 'Spin up a demo in minutes' %}</h2>
        <p class="card__text">{% trans 'Write your code in the Playground editor, save it, and showcase it in the gallery. New features land regularly.' %}</p>
      </div>
      <div class="button-row">
        <a href="{% url 'playground:editor' %}" class="btn btn--primary" data-cursor-interactive>{% trans 'Open editor' %}</a>
        <a href="{% url 'playground:gallery' %}" class="btn btn--ghost" data-cursor-interactive>{% trans 'Browse gallery' %}</a>
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
(function () {
  const cards = document.querySelectorAll('[data-animate-card]');
  if (!('IntersectionObserver' in window) || !cards.length) {
    cards.forEach((card) => card.classList.add('is-visible'));
    return;
  }
  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        entry.target.classList.add('is-visible');
        observer.unobserve(entry.target);
      }
    });
  }, { rootMargin: '0px 0px -10% 0px', threshold: 0.2 });
  cards.forEach((card) => {
    observer.observe(card);
  });
})();

function loadTemplate(templateId) {
  window.location.href = {% url 'playground:editor' %}?template=;
}
</script>
{% endblock %}
