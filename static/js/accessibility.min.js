class AccessibilityManager{constructor(){this.focusStack=[],this.liveRegions=new Map,this.keyboardListeners=new Map,this.contrastRatio={normal:4.5,large:3},this.motionPreference=window.matchMedia("(prefers-reduced-motion: reduce)"),this.contrastPreference=window.matchMedia("(prefers-contrast: high)"),this.preferences=this.loadPreferences(),this.init()}init(){this.setupLiveRegions(),this.setupKeyboardNavigation(),this.setupFocusManagement(),this.setupMotionPreferences(),this.setupContrastMonitoring(),this.setupTextScaling(),this.setupScreenReaderSupport(),this.monitorAccessibilityViolations(),this.addAccessibilityControls()}setupLiveRegions(){const e=document.createElement("div");e.setAttribute("aria-live","polite"),e.setAttribute("aria-atomic","true"),e.className="sr-only",e.id="accessibility-announcer",document.body.appendChild(e),this.liveRegions.set("announcer",e);const t=document.createElement("div");t.setAttribute("aria-live","assertive"),t.setAttribute("aria-atomic","true"),t.className="sr-only",t.id="accessibility-urgent-announcer",document.body.appendChild(t),this.liveRegions.set("urgent",t);const n=document.createElement("div");n.setAttribute("aria-live","polite"),n.setAttribute("aria-atomic","false"),n.className="sr-only",n.id="accessibility-status",document.body.appendChild(n),this.liveRegions.set("status",n)}announce(e,t="polite"){const n="assertive"===t?this.liveRegions.get("urgent"):this.liveRegions.get("announcer");n&&(n.textContent="",setTimeout(()=>{n.textContent=e},10),setTimeout(()=>{n.textContent===e&&(n.textContent="")},5e3))}updateStatus(e){const t=this.liveRegions.get("status");t&&(t.textContent=e)}setupKeyboardNavigation(){document.addEventListener("keydown",e=>{this.handleGlobalKeyboard(e)}),this.createSkipLinks(),this.setupRovingTabindex(),this.setupModalKeyboardHandling()}createSkipLinks(){const e=document.createElement("div");e.className="skip-links",e.innerHTML='\n            <a href="#main-content" class="skip-link">Skip to main content</a>\n            <a href="#navigation" class="skip-link">Skip to navigation</a>\n            <a href="#search" class="skip-link">Skip to search</a>\n        ',document.body.insertBefore(e,document.body.firstChild)}setupRovingTabindex(){document.querySelectorAll('[role="tablist"], [role="menubar"], [role="toolbar"]').forEach(e=>{this.initializeRovingTabindex(e)})}initializeRovingTabindex(e){const t=e.querySelectorAll('[role="tab"], [role="menuitem"], [role="button"]');if(0!==t.length){t[0].tabIndex=0;for(let e=1;e<t.length;e++)t[e].tabIndex=-1;e.addEventListener("keydown",e=>{const n=Array.from(t).indexOf(e.target);let o=n;switch(e.key){case"ArrowRight":case"ArrowDown":e.preventDefault(),o=(n+1)%t.length;break;case"ArrowLeft":case"ArrowUp":e.preventDefault(),o=n>0?n-1:t.length-1;break;case"Home":e.preventDefault(),o=0;break;case"End":e.preventDefault(),o=t.length-1}o!==n&&(t[n].tabIndex=-1,t[o].tabIndex=0,t[o].focus())})}}handleGlobalKeyboard(e){if(e.altKey&&"1"===e.key){e.preventDefault();const t=document.getElementById("main-content")||document.querySelector("main");t&&(t.focus(),this.announce("Jumped to main content"))}if(e.altKey&&"2"===e.key){e.preventDefault();const t=document.getElementById("navigation")||document.querySelector("nav");t&&(t.focus(),this.announce("Jumped to navigation"))}if(e.altKey&&"s"===e.key.toLowerCase()){e.preventDefault();const t=document.getElementById("search")||document.querySelector('[role="search"] input');t&&(t.focus(),this.announce("Jumped to search"))}"Escape"===e.key&&this.closeActiveModals()}setupModalKeyboardHandling(){document.addEventListener("keydown",e=>{if("Tab"===e.key){const t=document.querySelector('[role="dialog"]:not([aria-hidden="true"])');t&&this.trapFocus(e,t)}})}setupFocusManagement(){document.addEventListener("focusin",e=>{this.lastFocusedElement=e.target}),this.enhanceFocusVisibility(),this.setupAutoFocus()}trapFocus(e,t){const n=t.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),o=n[0],i=n[n.length-1];e.shiftKey?document.activeElement===o&&(e.preventDefault(),i.focus()):document.activeElement===i&&(e.preventDefault(),o.focus())}pushFocus(e){this.lastFocusedElement&&this.focusStack.push(this.lastFocusedElement),e&&e.focus()}popFocus(){const e=this.focusStack.pop();e&&document.contains(e)&&e.focus()}enhanceFocusVisibility(){const e=document.createElement("style");e.textContent="\n            .a11y-focus-enhanced *:focus {\n                outline: 3px solid #4A90E2 !important;\n                outline-offset: 2px !important;\n                box-shadow: 0 0 0 1px #ffffff !important;\n            }\n            \n            .a11y-high-contrast *:focus {\n                outline: 4px solid #FFFF00 !important;\n                outline-offset: 2px !important;\n                background-color: #000000 !important;\n                color: #FFFFFF !important;\n            }\n        ",document.head.appendChild(e)}setupAutoFocus(){new MutationObserver(e=>{e.forEach(e=>{e.addedNodes.forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){const t=e.querySelector("input, select, textarea, button");t&&"true"===e.getAttribute("data-auto-focus")&&setTimeout(()=>t.focus(),100)}})})}).observe(document.body,{childList:!0,subtree:!0})}setupMotionPreferences(){this.motionPreference.addEventListener("change",()=>{this.updateMotionPreferences()}),this.updateMotionPreferences()}updateMotionPreferences(){this.motionPreference.matches?(document.body.classList.add("reduce-motion"),this.announce("Reduced motion enabled")):document.body.classList.remove("reduce-motion")}setupContrastMonitoring(){this.contrastPreference.addEventListener("change",()=>{this.updateContrastPreferences()}),this.updateContrastPreferences(),this.auditContrast()}updateContrastPreferences(){this.contrastPreference.matches?(document.body.classList.add("high-contrast"),this.announce("High contrast mode enabled")):document.body.classList.remove("high-contrast")}auditContrast(){const e=document.querySelectorAll("*"),t=[];e.forEach(e=>{const n=window.getComputedStyle(e),o=n.backgroundColor,i=n.color;if("rgba(0, 0, 0, 0)"!==o&&"rgba(0, 0, 0, 0)"!==i){const a=this.calculateContrastRatio(i,o),s=parseFloat(n.fontSize),r=n.fontWeight,c=s>=18||s>=14&&("bold"===r||parseInt(r)>=700)?this.contrastRatio.large:this.contrastRatio.normal;a<c&&t.push({element:e,ratio:a.toFixed(2),required:c,colors:{foreground:i,background:o}})}}),t.length>0&&this.preferences.showContrastWarnings&&(console.group("Accessibility: Contrast Violations"),t.forEach(e=>{console.warn("Contrast ratio too low:",e)}),console.groupEnd())}calculateContrastRatio(e,t){const n=e=>{const t=e.match(/\d+/g);if(!t)return 0;const[n,o,i]=t.map(e=>{const t=parseInt(e)/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)});return.2126*n+.7152*o+.0722*i},o=n(e),i=n(t);return(Math.max(o,i)+.05)/(Math.min(o,i)+.05)}setupTextScaling(){this.textScale=this.preferences.textScale||1,this.applyTextScaling(),window.addEventListener("resize",()=>{this.detectZoomChange()})}applyTextScaling(){document.documentElement.style.setProperty("--text-scale",this.textScale),document.body.style.fontSize=`${this.textScale}rem`}changeTextScale(e){this.textScale=Math.max(.8,Math.min(2,e)),this.applyTextScaling(),this.savePreferences(),this.announce(`Text size changed to ${Math.round(100*this.textScale)}%`)}detectZoomChange(){const e=Math.round(100*window.devicePixelRatio);e!==this.lastZoom&&(this.lastZoom=e,e>150&&this.announce(`Browser zoom is at ${e}%. Consider using our built-in text scaling for better accessibility.`))}setupScreenReaderSupport(){this.addAriaLabels(),this.enhanceFormLabels(),this.addLandmarkRoles(),this.improveTableAccessibility()}addAriaLabels(){document.querySelectorAll("button, a, input, select, textarea").forEach(e=>{if(!e.getAttribute("aria-label")&&!e.getAttribute("aria-labelledby")){let t="";e.textContent.trim()?t=e.textContent.trim():e.getAttribute("title")?t=e.getAttribute("title"):e.getAttribute("placeholder")&&(t=e.getAttribute("placeholder")),t&&e.setAttribute("aria-label",t)}})}enhanceFormLabels(){document.querySelectorAll("input, select, textarea").forEach(e=>{if(!e.getAttribute("aria-labelledby")&&!e.getAttribute("aria-label")){const t=document.querySelector(`label[for="${e.id}"]`);t&&(e.setAttribute("aria-labelledby",t.id||this.generateId("label")),t.id||(t.id=e.getAttribute("aria-labelledby")))}e.required&&!e.getAttribute("aria-required")&&e.setAttribute("aria-required","true"),e.addEventListener("invalid",()=>{e.setAttribute("aria-invalid","true")}),e.addEventListener("input",()=>{e.checkValidity()&&e.removeAttribute("aria-invalid")})})}addLandmarkRoles(){[{selector:"header",role:"banner"},{selector:"nav",role:"navigation"},{selector:"main",role:"main"},{selector:"aside",role:"complementary"},{selector:"footer",role:"contentinfo"}].forEach(e=>{document.querySelectorAll(e.selector).forEach(t=>{t.getAttribute("role")||t.setAttribute("role",e.role)})})}improveTableAccessibility(){document.querySelectorAll("table").forEach(e=>{if(!e.querySelector("caption")&&!e.getAttribute("aria-label")){const t=document.createElement("caption");t.textContent="Data table",t.className="sr-only",e.insertBefore(t,e.firstChild)}e.querySelectorAll("th").forEach(e=>{if(!e.getAttribute("scope")){const t=e.parentElement.querySelector("th")===e;e.setAttribute("scope",t?"row":"col")}})})}addAccessibilityControls(){const e=document.createElement("div");e.className="accessibility-controls",e.setAttribute("role","region"),e.setAttribute("aria-label","Accessibility controls"),e.innerHTML=`\n            <button id="a11y-toggle" class="a11y-control-btn" aria-expanded="false" aria-controls="a11y-panel">\n                <span class="sr-only">Accessibility Options</span>\n                â™¿\n            </button>\n            <div id="a11y-panel" class="a11y-panel" aria-hidden="true">\n                <h3>Accessibility Options</h3>\n                <div class="a11y-option">\n                    <label for="text-scale-range">Text Size:</label>\n                    <input type="range" id="text-scale-range" min="0.8" max="2" step="0.1" value="${this.textScale}">\n                    <span id="text-scale-value">${Math.round(100*this.textScale)}%</span>\n                </div>\n                <div class="a11y-option">\n                    <label>\n                        <input type="checkbox" id="high-contrast-toggle" ${this.preferences.highContrast?"checked":""}>\n                        High Contrast\n                    </label>\n                </div>\n                <div class="a11y-option">\n                    <label>\n                        <input type="checkbox" id="reduce-motion-toggle" ${this.preferences.reduceMotion?"checked":""}>\n                        Reduce Motion\n                    </label>\n                </div>\n                <div class="a11y-option">\n                    <label>\n                        <input type="checkbox" id="focus-enhancement-toggle" ${this.preferences.focusEnhancement?"checked":""}>\n                        Enhanced Focus\n                    </label>\n                </div>\n            </div>\n        `,document.body.appendChild(e),this.setupControlsEventListeners()}setupControlsEventListeners(){const e=document.getElementById("a11y-toggle"),t=document.getElementById("a11y-panel"),n=document.getElementById("text-scale-range"),o=document.getElementById("text-scale-value"),i=document.getElementById("high-contrast-toggle"),a=document.getElementById("reduce-motion-toggle"),s=document.getElementById("focus-enhancement-toggle");e.addEventListener("click",()=>{const n="true"===e.getAttribute("aria-expanded");e.setAttribute("aria-expanded",!n),t.setAttribute("aria-hidden",n),t.classList.toggle("open")}),n.addEventListener("input",()=>{const e=parseFloat(n.value);this.changeTextScale(e),o.textContent=`${Math.round(100*e)}%`}),i.addEventListener("change",()=>{this.preferences.highContrast=i.checked,document.body.classList.toggle("a11y-high-contrast",i.checked),this.savePreferences(),this.announce(i.checked?"High contrast enabled":"High contrast disabled")}),a.addEventListener("change",()=>{this.preferences.reduceMotion=a.checked,document.body.classList.toggle("reduce-motion",a.checked),this.savePreferences(),this.announce(a.checked?"Reduced motion enabled":"Reduced motion disabled")}),s.addEventListener("change",()=>{this.preferences.focusEnhancement=s.checked,document.body.classList.toggle("a11y-focus-enhanced",s.checked),this.savePreferences(),this.announce(s.checked?"Focus enhancement enabled":"Focus enhancement disabled")})}monitorAccessibilityViolations(){this.preferences.showViolationWarnings&&(this.checkImages(),this.checkFormLabels(),this.checkHeadingHierarchy(),this.checkColorOnlyInformation())}checkImages(){const e=document.querySelectorAll("img"),t=[];e.forEach(e=>{e.getAttribute("alt")||e.getAttribute("aria-label")||t.push(e)}),t.length>0&&(console.group("Accessibility: Missing Alt Text"),t.forEach(e=>{console.warn("Image missing alt text:",e),"true"===e.getAttribute("data-decorative")&&e.setAttribute("alt","")}),console.groupEnd())}checkFormLabels(){const e=document.querySelectorAll("input, select, textarea"),t=[];e.forEach(e=>{"hidden"===e.type||e.getAttribute("aria-label")||e.getAttribute("aria-labelledby")||document.querySelector(`label[for="${e.id}"]`)||t.push(e)}),t.length>0&&(console.group("Accessibility: Missing Form Labels"),t.forEach(e=>{console.warn("Form input missing label:",e)}),console.groupEnd())}checkHeadingHierarchy(){const e=Array.from(document.querySelectorAll("h1, h2, h3, h4, h5, h6")),t=[];let n=0;e.forEach(e=>{const o=parseInt(e.tagName.substring(1));o-n>1&&t.push({element:e,issue:`Heading level jumps from h${n} to h${o}`}),n=o}),t.length>0&&(console.group("Accessibility: Heading Hierarchy Issues"),t.forEach(e=>{console.warn(e.issue,e.element)}),console.groupEnd())}checkColorOnlyInformation(){document.querySelectorAll('[style*="color:"], .text-red, .text-green, .text-blue').forEach(e=>{e.textContent.match(/error|warning|success|required/i)&&(e.getAttribute("aria-label")||e.querySelector(".sr-only")||console.warn("Accessibility: Possible color-only information",e))})}generateId(e="a11y"){return`${e}-${Math.random().toString(36).substr(2,9)}`}closeActiveModals(){document.querySelectorAll('[role="dialog"]:not([aria-hidden="true"])').forEach(e=>{const t=e.querySelector('.close, [aria-label*="close"], [data-dismiss]');t?t.click():(e.setAttribute("aria-hidden","true"),this.popFocus())})}loadPreferences(){try{const e=localStorage.getItem("accessibilityPreferences");return e?JSON.parse(e):{textScale:1,highContrast:!1,reduceMotion:!1,focusEnhancement:!1,showViolationWarnings:!0,showContrastWarnings:!1}}catch(e){return{textScale:1,highContrast:!1,reduceMotion:!1,focusEnhancement:!1,showViolationWarnings:!0,showContrastWarnings:!1}}}savePreferences(){try{localStorage.setItem("accessibilityPreferences",JSON.stringify(this.preferences))}catch(e){console.warn("Unable to save accessibility preferences")}}enable(){document.body.classList.add("accessibility-enabled"),this.announce("Accessibility features enabled")}disable(){document.body.classList.remove("accessibility-enabled"),this.announce("Accessibility features disabled")}getViolations(){return{images:this.checkImages(),forms:this.checkFormLabels(),headings:this.checkHeadingHierarchy(),contrast:this.auditContrast()}}}const accessibilityManager=new AccessibilityManager;window.AccessibilityManager=accessibilityManager,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{accessibilityManager.enable()}):accessibilityManager.enable();
//# sourceMappingURL=accessibility.min.js.map